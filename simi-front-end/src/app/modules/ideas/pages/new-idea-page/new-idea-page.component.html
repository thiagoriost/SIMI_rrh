<form [formGroup]="formulario" (ngSubmit)="onSave('submit')" class="newIdeaContainer" autocomplete="off">

  <div class="breadCrumb" > <span class="pointer" (click)="goDashBoard()" tabindex="0" (keydown)="goDashBoard()">Ideas</span> · Registrar idea</div>

  <div class="title1Div">
    <h1 class="tittle1">{{(formulario.value[Descripcion_Valor_Estado] === Devuelta) ? 'Subsanar Idea' : 'Registrar Idea'}}</h1>
  </div>

  <app-toast-msg mensaje="{{textToastMensaje}}"></app-toast-msg>

  @if(modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_devolucion){
    <app-revisiones [Id_Idea_Investigacion_Seleccionada]="Id_Idea_Investigacion_Seleccionada"></app-revisiones>
  }

  <!-- Geenral del Proponente -->
  <app-general-proponente [formularioPadre]="formulario" [modoVista]="modoVistaFormularioIdeaInvestigacion"
   [validacionFecha]="validacionFecha" [validacionCampo]="validacionCampo"
   [validacionEntidad]="validacionEntidad"
   >
  </app-general-proponente>


  <!-- Aspectos técnicos de la ídea de Investigación, Desarrollo tecnológico o Innovación -->
  <div class="aspectosTecnicos">
    <div class="mt20 gdp">
       <h2>Aspectos técnicos de la ídea de Investigación, Desarrollo tecnológico o Innovación</h2>
     </div>

     <div class="aspectosTecnicos full-width">

       <div class="fieldImputText">
         <p class="label">Título de la ídea</p>
         @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
           <p class="label2">Un buen título, además de la exactitud y la confiabilidad, debe ser claro, conciso, específico
             y, si es posible, llamativo de forma tal que capture la atención del lector y enmarque la ídea principal.</p>
         }
         <mat-form-field class="matFormField">
           <textarea formControlName="Titulo_Idea" readonly="{{modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver}}" #idea class="textA" matInput placeholder="Título de la ídea" value=""></textarea>
           @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){<mat-hint align="end" style="text-align: end;">{{idea.value.length}} / 200</mat-hint>}
           @if (!validacionCampo("Titulo_Idea")) { <mat-error>{{getErrorCampo("Titulo_Idea")}}</mat-error> }
         </mat-form-field>
       </div>

       <br />

       <mat-divider class="divider"></mat-divider>

       <app-tipo-proyecto [formulario]="formulario" [modoVer]="modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver"
        [banderaValidacionTipoProyectoSeleccionando]="banderaValidacionTipoProyectoSeleccionando"
       ></app-tipo-proyecto>

       <mat-divider></mat-divider>

       <app-grupos-investigacion [formulario]="formulario" [modoVista]="modoVistaFormularioIdeaInvestigacion"
        [banderaValidacionLineasInvestigacionSeleccionadas]="banderaValidacionLineasInvestigacionSeleccionadas"
       ></app-grupos-investigacion>

       <mat-divider></mat-divider>

       <div class="fieldImputText">
         <p class="label">URL Cronograma</p>
         @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
           <p class="label2">url del directorio donde se encuentre el documento cronograma preliminar del proyecto, defina responsables y duración de este.</p>
         }
         <mat-form-field class="matFormField">
           <textarea formControlName="URL_Cronograma" #tiempo class="textA" readonly="{{modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver}}" matInput placeholder="URL del Cronograma"></textarea>
           @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){<mat-hint align="end" style="text-align: end;">{{tiempo.value.length}} / 150</mat-hint>}
           @if (!validacionCampo("URL_Cronograma")) { <mat-error>{{getErrorCampo("URL_Cronograma")}}</mat-error> }
         </mat-form-field>
       </div>
       <mat-divider></mat-divider>

       <div class="fieldImputText">
         <p class="label">Tiempo de ejecución del proyecto I+D+i</p>
         @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
           <p class="label2">Establezca un cronograma preliminar del proyecto y duración del mismo en meses.</p>
         }
         <mat-form-field class="matFormField">
           <input maxlength="50"  formControlName="Tiempo_Ejecucion_Proyecto" #tiempo class="textA" readonly="{{modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver}}" type="number" matInput placeholder="Tiempo de ejecución del proyecto I+D+i">
           @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){<mat-hint align="end" style="text-align: end;">{{tiempo.value.length}} / 50</mat-hint>}
           @if (!validacionCampo("Tiempo_Ejecucion_Proyecto")) { <mat-error>{{getErrorCampo("Tiempo_Ejecucion_Proyecto")}}</mat-error> }
         </mat-form-field>
       </div>

       <div class="fieldImputText">
         <mat-form-field class="matFormField">
           <p class="label">Lugar de ejecución</p>
           @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
             <p class="label2">Defina el lugar donde se ejecutará el proyecto I+D+i.</p>
           }
           <textarea formControlName="Lugar_Ejecucion" #lugar class="textA" matInput readonly="{{modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver}}"
             placeholder="Defina el lugar donde se ejecutará el proyecto I+D+i"></textarea>
           @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){<mat-hint align="end" style="text-align: end;">{{lugar.value.length}} / 50</mat-hint>}
           @if (!validacionCampo("Lugar_Ejecucion")) { <mat-error>{{getErrorCampo("Lugar_Ejecucion")}}</mat-error> }
         </mat-form-field>
       </div>

       <p class="label">Productos resultados de la investigación</p>
       @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
         <p class="label2">Identificaser, seleccionar y relacionar los productos resultado de la investigación que se
           obtienen, segun las tipologías de
           Minciencias corresponden a: Generación de nuevo conocimiento, desarrollo tecnológico e innovación; Apropiación
           social del conocimiento y divulgación
           pública de la ciencia y la Formación de recurso humano en ciencia Tecnología e Innovación - CTeI.</p>
       }
       <div class="fieldImputText ml_15">
        @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver || ((modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver) && formulario.value["Nuevo_Conocimiento"])) {
          <div class="fieldImputText">
            <p class="label">Productos resultados de actividades de Generación de Nuevo Conocimiento</p>
            @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
              <p class="label2">Identificar y establecer los productos esperados en el proyecto. Minciencias 2021: Articulos
                de investigación,
                tipo A1, A2, B, C y D; Notas cientificas, tipo A1, A2, B, C y D; Libros resultados de investigación; Libros
                de formación en cuartil Q1;
                Capitulos en libro resultadosd e investigación; Productos tecnológicos patentados o en proceso de concesión
                de la patente; Variedades
                vegetales, variedades animales y poblaciones mejoradas de razas pecuarias y obras o productos resultados de
                creación e
                investigación-creación, Arquitectura y Diseño
              </p>
            }
            <mat-form-field class="matFormField">
              <textarea matInput formControlName="Nuevo_Conocimiento" #Productos class="textA" matInput readonly="{{modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver}}"
                placeholder="Productos resultados de actividades de Generación de Nuevo Conocimiento"></textarea>
              @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){<mat-hint align="end" style="text-align: end;">{{Productos.value.length}} / 200</mat-hint>}
              @if (!validacionCampo("Nuevo_Conocimiento")) { <mat-error>{{getErrorCampo("Nuevo_Conocimiento")}}</mat-error> }
            </mat-form-field>
          </div>
        }
         @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver || ((modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver) && formulario.value["Tecnologico_Innovacion"])) {
           <div class="fieldImputText">
             <p class="label">Productos resultados de actividades de Desarrollo tecnológico e Innovación</p>
             @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
               <p class="label2">Identificar y establecer el producto esperados en el proyecto. Minciencias 2021: Productos
                 empresariales, regulaciones,
                 normas, reglamentos o legislaciones, Conceptos técnicos y Registros de Acuerdos de licencia para explotación
                 de obras de investigación + Creación en Artes,
                 Arquitectura y Diseño protegidas por derechos de auto.
               </p>
             }
             <mat-form-field class="matFormField">
               <textarea matInput formControlName="Tecnologico_Innovacion" #ProductosDesarrollo class="textA" matInput readonly="{{modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver}}"
                 placeholder="Productos resultados de actividades de Desarrollo tecnológico e Innovación"></textarea>
               @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){<mat-hint align="end" style="text-align: end;">{{ProductosDesarrollo.value.length}} / 200</mat-hint>}
               @if (!validacionCampo("Tecnologico_Innovacion")) { <mat-error>{{getErrorCampo("Tecnologico_Innovacion")}}</mat-error> }
             </mat-form-field>
           </div>
         }
         @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver || ((modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver) && formulario.value["Apropiacion_Conocimiento"])) {
           <div class="fieldImputText">
             <p class="label">Productos resultados de actividades de Apropiación Social del Conocimiento y Divulgación
               Publica de la Ciencia</p>
               @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
                 <p class="label2">Identificar y establecer el producto esperados en el proyecto. Minciencias 2021:
                   Reconocimiento de Contexto. la Participación;
                   Dialogo de Saberes y conocimientos; Confianza y Reflexión Crítica
                 </p>
               }
             <mat-form-field class="matFormField">
               <textarea matInput formControlName="Apropiacion_Conocimiento" #ProductosApropiacion class="textA" matInput readonly="{{modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver}}"
                 placeholder="Productos resultados de actividades de Apropiación Social del Conocimiento y Divulgación Publica de la Ciencia"></textarea>
               @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){<mat-hint align="end" style="text-align: end;">{{ProductosApropiacion.value.length}} / 200</mat-hint>}
               @if (!validacionCampo("Apropiacion_Conocimiento")) { <mat-error>{{getErrorCampo("Apropiacion_Conocimiento")}}</mat-error> }
             </mat-form-field>
           </div>
         }
         @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver || ((modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver) && formulario.value["Formacion_CTEL"])) {
           <div class="fieldImputText">
             <p class="label">Productos resultados de actividades de Formación del Recurso Humano para la CTeI</p>
             @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
               <p class="label2">Identificar y establecer el producto esperados en el proyecto. Minciencias 2021: Realización
                 de una tésis o trabajo de grado
                 que otorga el título de doctor(a), magister o profesional (respectivamente); la ejecución de proyectos de
                 ID+I con formación y apoyo a programas
                 de formación; y la gestión de proyectos de investigación que permitan la consecución de los recursos
                 necesarios para el desarrollo de la investigación
                 o la innovación.
               </p>
             }
             <mat-form-field class="matFormField">
               <textarea matInput formControlName="Formacion_CTEL" #ProductosFRH class="textA" matInput readonly="{{modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver}}"
                 placeholder="Productos resultados de actividades de Formación del Recurso Humano para la CTeI"></textarea>
               @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){<mat-hint align="end" style="text-align: end;">{{ProductosFRH.value.length}} / 200</mat-hint>}
               @if (!validacionCampo("Formacion_CTEL")) { <mat-error>{{getErrorCampo("Formacion_CTEL")}}</mat-error> }
             </mat-form-field>
           </div>

         }

       </div>

       <div class="formStyleFields">

        @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver) {
          <div class="fieldImputText">
          <mat-divider class="divider"></mat-divider>
          <p class="label">{{camposFieldEditText[0].label}}</p>
          @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
            <p class="label2">{{camposFieldEditText[0].SubLabel}}</p>
          }
          <div class="containerEditor">
                  <angular-editor id="{{camposFieldEditText[0].nameField}}" [placeholder]="'Ingresar texto...'"
                    formControlName="{{camposFieldEditText[0].nameField}}" [config]="config"></angular-editor>
          </div>
          @if (camposFieldEditText[0].validacion) { <mat-error>Este campo es requerido</mat-error> }

          </div>
          <div class="fieldImputText">
            <mat-divider class="divider"></mat-divider>
            <p class="label">{{camposFieldEditText[1].label}}</p>
            @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
              <p class="label2">{{camposFieldEditText[1].SubLabel}}</p>
            }
            <div class="containerEditor">
                    <angular-editor id="{{camposFieldEditText[1].nameField}}" [placeholder]="'Ingresar texto...'"
                      formControlName="{{camposFieldEditText[1].nameField}}" [config]="config"></angular-editor>
            </div>
            @if (camposFieldEditText[1].validacion) { <mat-error>Este campo es requerido</mat-error> }

          </div>
          <div class="fieldImputText">
            <mat-divider class="divider"></mat-divider>
            <p class="label">{{camposFieldEditText[2].label}}</p>
            @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
              <p class="label2">{{camposFieldEditText[2].SubLabel}}</p>
            }
            <div class="containerEditor">
                    <angular-editor id="{{camposFieldEditText[2].nameField}}" [placeholder]="'Ingresar texto...'"
                      formControlName="{{camposFieldEditText[2].nameField}}" [config]="config"></angular-editor>
            </div>
            @if (camposFieldEditText[2].validacion) { <mat-error>Este campo es requerido</mat-error> }

          </div>
          <div class="fieldImputText">
            <mat-divider class="divider"></mat-divider>
            <p class="label">{{camposFieldEditText[3].label}}</p>
            @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver){
              <p class="label2">{{camposFieldEditText[3].SubLabel}}</p>
            }
            <div class="containerEditor">
                    <angular-editor id="{{camposFieldEditText[3].nameField}}" [placeholder]="'Ingresar texto...'"
                      formControlName="{{camposFieldEditText[3].nameField}}" [config]="config"></angular-editor>
            </div>
            @if (camposFieldEditText[3].validacion) { <mat-error>Este campo es requerido</mat-error> }

          </div>
          <div class="fieldImputText">
            <mat-divider class="divider"></mat-divider>
            <p class="label">{{camposFieldEditText[4].label}}</p>
            <p class="label2">{{camposFieldEditText[4].SubLabel}}</p>
            <div class="containerEditor">
                    <angular-editor id="{{camposFieldEditText[4].nameField}}" [placeholder]="'Ingresar texto...'"
                      formControlName="{{camposFieldEditText[4].nameField}}" [config]="config"></angular-editor>
            </div>
            @if (camposFieldEditText[4].validacion) { <mat-error>Este campo es requerido</mat-error> }

          </div>
        }
        @if(modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver) {
          <app-edit-text-rich
            [formulario]="formulario" [modoVer]="modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver"
            [camposFieldEditText]="camposFieldEditText"></app-edit-text-rich>
        }


      </div>

     </div>
     <div class="btnToSave">
       @if (modoVistaFormularioIdeaInvestigacion !== modos_VistaFormulario.modo_ver) {
          <button
                  (click)="onSave((formulario.value[Descripcion_Valor_Estado] === Devuelta)?'editar':'registrar')"
                  mat-raised-button
                  disabledInteractive
                  matTooltip="This is a tooltip!"
                  class="btnNewIdea"
                  color="primary"
                >
                  {{(formulario.value[Descripcion_Valor_Estado] === Devuelta)?'ENVIAR AJUSTE':'REGISTRAR IDEA'}}
          </button>
       }
       @if (modoVistaFormularioIdeaInvestigacion === modos_VistaFormulario.modo_ver) {
        <button
                  (click)="onSave('regresar')"
                  mat-raised-button
                  disabledInteractive
                  matTooltip="This is a tooltip!"
                  class="btnNewIdea"
                  color="primary"
                >
                  REGRESAR
          </button>
       }

     </div>
  </div>


</form>
